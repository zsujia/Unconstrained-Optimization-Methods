% 共轭梯度法cgm、最速下降法sd、牛顿法nm
% f(x) = 1/2 *x'*A*x+b'x+c
% 求函数的极小值点
function Main()
A = [0.4788    0.0662    0.0616    0.0394   -0.1161   -0.0244   -0.0103   -0.0451   -0.1327    0.0904   -0.0022    0.0349    0.0148    0.0369    0.0560    0.0836   -0.0456   -0.1205    0.1462    0.0351
    0.0662    0.5064    0.0392   -0.0474    0.1194    0.0796    0.0489   -0.1040    0.1200   -0.0293   -0.0074    0.0006   -0.0503   -0.0892   -0.1179   -0.0491   -0.0348   -0.0667    0.0858    0.0215
    0.0616    0.0392    0.5402   -0.0045    0.0647   -0.0606    0.0128   -0.0019   -0.0636    0.1054   -0.1389    0.1145   -0.0198   -0.0107    0.0233   -0.0059    0.0258   -0.0950   -0.0608   -0.0083
    0.0394   -0.0474   -0.0045    0.4234    0.0793   -0.0521   -0.0189   -0.0781    0.1109   -0.0144   -0.1421   -0.0937   -0.0028   -0.0025   -0.0315    0.0642    0.0642    0.0345    0.0200   -0.1267
   -0.1161    0.1194    0.0647    0.0793    0.4756    0.0469   -0.0724    0.1102    0.1142    0.1431    0.0606   -0.0576    0.0758    0.0041   -0.1039   -0.0225   -0.0749    0.0313   -0.0798    0.0328
   -0.0244    0.0796   -0.0606   -0.0521    0.0469    0.4805    0.0523    0.0500   -0.0417   -0.1175    0.0788    0.0384    0.0113    0.1210    0.0397    0.1154    0.0663   -0.0340    0.0155   -0.2140
   -0.0103    0.0489    0.0128   -0.0189   -0.0724    0.0523    0.4843   -0.1235   -0.0122    0.0402   -0.0083   -0.1307    0.1484   -0.0441    0.0579    0.0936    0.0602   -0.0424   -0.1910   -0.0303
   -0.0451   -0.1040   -0.0019   -0.0781    0.1102    0.0500   -0.1235    0.4782   -0.1256   -0.0472    0.0494   -0.0818   -0.0359   -0.0644    0.0085    0.1003   -0.0477   -0.0564    0.0288    0.0067
   -0.1327    0.1200   -0.0636    0.1109    0.1142   -0.0417   -0.0122   -0.1256    0.4291   -0.0477    0.1481    0.0375   -0.0380   -0.0441    0.0099    0.0498   -0.0149    0.0673    0.0055    0.0154
    0.0904   -0.0293    0.1054   -0.0144    0.1431   -0.1175    0.0402   -0.0472   -0.0477    0.5117    0.1456   -0.0317    0.0037   -0.0206    0.0969   -0.0446   -0.1018    0.0930   -0.0552   -0.0268
   -0.0022   -0.0074   -0.1389   -0.1421    0.0606    0.0788   -0.0083    0.0494    0.1481    0.1456    0.5259   -0.0192   -0.0642   -0.0425    0.0868   -0.0645   -0.0583   -0.0769    0.0080   -0.0409
    0.0349    0.0006    0.1145   -0.0937   -0.0576    0.0384   -0.1307   -0.0818    0.0375   -0.0317   -0.0192    0.5525    0.0679   -0.0243    0.0584    0.0011   -0.0271    0.0424   -0.1068   -0.0052
    0.0148   -0.0503   -0.0198   -0.0028    0.0758    0.0113    0.1484   -0.0359   -0.0380    0.0037   -0.0642    0.0679    0.6003   -0.0784    0.0331    0.0597   -0.1993    0.0915   -0.0550    0.0206
    0.0369   -0.0892   -0.0107   -0.0025    0.0041    0.1210   -0.0441   -0.0644   -0.0441   -0.0206   -0.0425   -0.0243   -0.0784    0.5693    0.0227    0.0266   -0.1020   -0.0270   -0.0858    0.0521
    0.0560   -0.1179    0.0233   -0.0315   -0.1039    0.0397    0.0579    0.0085    0.0099    0.0969    0.0868    0.0584    0.0331    0.0227    0.4189    0.2231    0.0694   -0.0184    0.0217    0.0263
    0.0836   -0.0491   -0.0059    0.0642   -0.0225    0.1154    0.0936    0.1003    0.0498   -0.0446   -0.0645    0.0011    0.0597    0.0266    0.2231    0.4839    0.0264    0.0666    0.0456    0.0960
   -0.0456   -0.0348    0.0258    0.0642   -0.0749    0.0663    0.0602   -0.0477   -0.0149   -0.1018   -0.0583   -0.0271   -0.1993   -0.1020    0.0694    0.0264    0.5250   -0.0544    0.0362   -0.0205
   -0.1205   -0.0667   -0.0950    0.0345    0.0313   -0.0340   -0.0424   -0.0564    0.0673    0.0930   -0.0769    0.0424    0.0915   -0.0270   -0.0184    0.0666   -0.0544    0.3642    0.0663   -0.0556
    0.1462    0.0858   -0.0608    0.0200   -0.0798    0.0155   -0.1910    0.0288    0.0055   -0.0552    0.0080   -0.1068   -0.0550   -0.0858    0.0217    0.0456    0.0362    0.0663    0.4371   -0.0339
0.0351    0.0215   -0.0083   -0.1267    0.0328   -0.2140   -0.0303    0.0067    0.0154   -0.0268   -0.0409   -0.0052    0.0206    0.0521    0.0263    0.0960   -0.0205   -0.0556   -0.0339    0.5661];
b=[0.8147    0.9058    0.1270    0.9134    0.6324    0.0975    0.2785    0.5469    0.9575    0.9649    0.1576    0.9706    0.9572    0.4854    0.8003    0.1419    0.4218    0.9157    0.7922    0.9595]';
c=0;
x0= [0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000]';
max_iter=10000;
n = size(A,1);  % A's dimension
fprintf('CGM:\n');
[min_cgm,iter_cgm,array_cgm] = cgm (A,b,x0,max_iter);
fprintf('NM:\n');
[min_nm,iter_nm,array_nm] = nm(A,b,x0,max_iter);
fprintf('SD:\n');
[min_sd,iter_sd,array_sd] = sd(A,b,x0,max_iter);

% get a graph
[x_cgm,y_cgm] = get_graph(min_cgm,iter_cgm,array_cgm);
[x_nm,y_nm] = get_graph(min_nm,iter_nm,array_nm);
[x_sd,y_sd] = get_graph(min_sd,iter_sd,array_sd);

plot(x_sd,y_sd,'r');
hold on
plot(x_cgm,y_cgm,'g');
hold on
plot(x_nm,y_nm,'b');
legend('sd','cgm','nm');
end

